<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Mulid Tools 테스트 완전판</title>
<style>
  body { font-family: Arial; padding: 20px; }
  h1 { color: #333; }
  #status { margin-top: 10px; font-weight: bold; }
  #downloadLink { margin-top: 10px; display: inline-block; background: #4CAF50; color: white; padding: 5px 10px; text-decoration: none; border-radius: 5px; }
  #downloadLink:hover { background: #45a049; }
</style>
</head>
<body>
<h1>Mulid Tools 테스트</h1>

<input type="file" id="fileInput">
<select id="formatSelect">
  <option value="wav">오디오 → WAV</option>
  <option value="mp4">영상 → MP4</option>
  <option value="png">이미지 → PNG</option>
</select>
<button id="convertBtn">변환 시작</button>

<div id="status"></div>
<a id="downloadLink" style="display:none;">다운로드</a>

<script>
const SERVER_URL = 'https://mulid-tools-server.onrender.com'; // Render 서버 주소

const fileInput = document.getElementById('fileInput');
const formatSelect = document.getElementById('formatSelect');
const convertBtn = document.getElementById('convertBtn');
const status = document.getElementById('status');
const downloadLink = document.getElementById('downloadLink');

convertBtn.onclick = async () => {
  if (!fileInput.files[0]) { alert('파일 선택!'); return; }
  const file = fileInput.files[0];
  const format = formatSelect.value;

  const formData = new FormData();
  formData.append('file', file);
  formData.append('format', format);

  status.textContent = '변환 중...';
  downloadLink.style.display = 'none';

  try {
    const res = await fetch(`${SERVER_URL}/convert/` + 
      (format === 'wav' ? 'audio' : format === 'mp4' ? 'video' : 'image'),
      { method: 'POST', body: formData }
    );
    const data = await res.json();

    if (data.success) {
      status.textContent = '✅ 변환 완료!';
      downloadLink.href = SERVER_URL + data.output;
      downloadLink.textContent = '⬇️ 다운로드: ' + data.output.split('/').pop();
      downloadLink.style.display = 'inline-block';
    } else {
      status.textContent = '❌ 변환 실패: ' + data.message;
    }
  } catch(err) {
    status.textContent = '⚠️ 오류 발생: ' + err;
  }
};
</script>
</body>
</html>
